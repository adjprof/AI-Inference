# Reference: https://github.com/BenBrostoff/ml-series-source/blob/master/src/4_decision_tree_intro.ipynb

a_vote = ['NA','D','R']
v_vote = [0,1,2]
p_vote = [0.05,0.8,0.15]

#with open('IA_synthetic_USCensusDist_full_data_Output.csv', newline='') as csvfile:
#    features = list(csv.reader(csvfile))

#with open('k_3_anon_IA_USCensusDist_data_full.csv', newline='') as csvfile:
#    features = list(csv.reader(csvfile))

with open('k_30_anon_IA_USCensusDist_data_full.csv', newline='') as csvfile:
    features = list(csv.reader(csvfile))
    
features = np.delete(features, [0], 0)
features = np.delete(features, [0,1,9], 1)
    
labels = np.random.choice(v_vote, len(features), p=p_vote)

X_train, X_test, y_train, y_test = train_test_split(
    features,
    labels,
    test_size=0.3,
    random_state=42,
)

clf = tree.DecisionTreeClassifier()
clf.fit(X=X_train, y=y_train)
clf.feature_importances_ 
clf.score(X=X_test, y=y_test)

# Predict, referenced from Matt
y_predict = clf.predict(X_train)

## Test how accurate we are
print(accuracy_score(y_train, y_predict))

## Check confusion matrix
print(confusion_matrix(y_train, y_predict))

--------------------------

target,
a_vote = ['NA','D','R']
v_vote = [0,1,2]
p_vote = [0.1,0.5,0.4]
raw data, 
clf.score(X=X_test, y=y_test) 
0.4512926367510273
print(accuracy_score(y_train, y_predict))
0.6268649426067135
print(confusion_matrix(y_train, y_predict))
[[  9546  19770   7569]
 [  3212 153568  27347]
 [  2866  76740  67892]]
print(accuracy_score(y_test, y_predict))
0.4538190245230572
print(confusion_matrix(y_test, y_predict))
[[  756 10590  4363]
 [ 3744 53363 21981]
 [ 3040 42542 17554]]

k=2, actual k=17, 
clf.score(X=X_test, y=y_test) 
0.5024924706615432
print(accuracy_score(y_train, y_predict))
0.4978079448091688
print(confusion_matrix(y_train, y_predict))
[[    0  4374   149]
 [    0 21650   642]
 [    0 17401   719]]
print(accuracy_score(y_test, y_predict))
0.5008827500259633
print(confusion_matrix(y_test, y_predict))
[[   0 1873   35]
 [   0 9545  141]
 [   0 7563  101]]

k=30, actual k=156, 
clf.score(X=X_test, y=y_test) 
0.4953785439817219
print(accuracy_score(y_train, y_predict))
0.49974407477467453
print(confusion_matrix(y_train, y_predict))
[[    0  4419    71]
 [    0 22209   215]
 [    0 17774   247]]
print(accuracy_score(y_test, y_predict))
0.4953785439817219
print(confusion_matrix(y_test, y_predict))
 [[   0 2014   34]
 [   0 9383  193]
 [   0 7477  157]]
 
---------------------------

target
a_vote = ['NA','D','R']
v_vote = [0,1,2]
p_vote = [0.05,0.8,0.15]

raw data, 
clf.score(X=X_test, y=y_test) 
0.7616710883729176
print(accuracy_score(y_train, y_predict))
0.8279802447694771
print(confusion_matrix(y_train, y_predict))
[[  3973  14370    118]
 [  1512 292659    790]
 [   515  46086   8487]]

k=3, actual k=17, 
clf.score(X=X_test, y=y_test) 
0.8014331706303873
print(accuracy_score(y_train, y_predict))
0.8005786135529097
print(confusion_matrix(y_train, y_predict))
[[    0  2338     0]
 [    0 35974     0]
 [    0  6623     0]]

k=30, actual k=156, 
clf.score(X=X_test, y=y_test) 
0.8010177588534635
print(accuracy_score(y_train, y_predict))
0.8000445087348392
print(confusion_matrix(y_train, y_predict))
[[    0  2202     0]
 [    0 35950     0]
 [    0  6783     0]]
